{% extends "base.html" %}

{% block title %}ÏÇ¨Ïö©Ïûê ÏÑ∏ÏÖò Î∂ÑÏÑù - Í¥ÄÎ¶¨Ïûê{% endblock %}

{% block content %}
<div class="container mt-5">
    <!-- Ìó§Îçî -->
    <div class="row mb-4">
        <div class="col">
            <div class="d-flex justify-content-between align-items-center">
                <h2><i class="bi bi-person-badge me-2"></i>ÏÇ¨Ïö©Ïûê ÏÑ∏ÏÖò Î∂ÑÏÑù</h2>
                <div>
                    <a href="{{ url_for('admin.dashboard') }}" class="btn btn-outline-secondary me-2">
                        <i class="bi bi-arrow-left me-1"></i>ÎåÄÏãúÎ≥¥ÎìúÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
                    </a>
                    <a href="{{ url_for('admin.export_sessions', days=days) }}" class="btn btn-info">
                        <i class="bi bi-download me-1"></i>ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌÜµÍ≥Ñ ÎåÄÏãúÎ≥¥Îìú -->
    <div class="row mb-4 g-3">
        <!-- Ï¥ù ÏÑ∏ÏÖò Ïàò -->
        <div class="col-md-3 col-sm-6">
            <div class="stats-card bg-primary-subtle">
                <div class="stats-icon bg-primary">
                    <i class="bi bi-graph-up"></i>
                </div>
                <div class="stats-content">
                    <h3>{{ stats.total_sessions or total_count }}</h3>
                    <p>Ï¥ù ÏÑ∏ÏÖò Ïàò</p>
                </div>
            </div>
        </div>
        <!-- Í≥†Ïú† Î∞©Î¨∏Ïûê -->
        <div class="col-md-3 col-sm-6">
            <div class="stats-card bg-success-subtle">
                <div class="stats-icon bg-success">
                    <i class="bi bi-people"></i>
                </div>
                <div class="stats-content">
                    <h3>{{ stats.unique_visitors or 0 }}</h3>
                    <p>Í≥†Ïú† Î∞©Î¨∏Ïûê</p>
                </div>
            </div>
        </div>
        <!-- Ï¥ù ÌÜ†ÌÅ∞ ÏÇ¨Ïö©Îüâ -->
        <div class="col-md-3 col-sm-6">
            <div class="stats-card bg-warning-subtle">
                <div class="stats-icon bg-warning">
                    <i class="bi bi-cpu"></i>
                </div>
                <div class="stats-content">
                    <h3>{{ "{:,}".format(stats.total_tokens|int) if stats.total_tokens else 0 }}</h3>
                    <p>ÌÜ†ÌÅ∞ ÏÇ¨Ïö©Îüâ</p>
                </div>
            </div>
        </div>
        <!-- Ï¥ù ÎπÑÏö© -->
        <div class="col-md-3 col-sm-6">
            <div class="stats-card bg-danger-subtle">
                <div class="stats-icon bg-danger">
                    <i class="bi bi-currency-dollar"></i>
                </div>
                <div class="stats-content">
                    <h3>US${{ "%.2f" | format(stats.total_cost or 0) }}</h3>
                    <p>Ï¥ù ÎπÑÏö©</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Î∂ÑÏÑù Ï∞®Ìä∏ ÏòÅÏó≠ -->
    <div class="row mb-4 g-3">
        <!-- Íµ≠Í∞ÄÎ≥Ñ ÌÜµÍ≥Ñ -->
        <div class="col-md-6 col-lg-4">
            <div class="card analysis-card">
                <div class="card-header">
                    <i class="bi bi-globe me-2"></i>Íµ≠Í∞ÄÎ≥Ñ Î∞©Î¨∏Ïûê
                </div>
                <div class="card-body">
                    {% if stats.by_country %}
                        <div class="stats-list">
                            {% for country, count in stats.by_country.items()|sort(attribute='1', reverse=true)|list[:5] %}
                            <div class="stats-item">
                                <span class="stats-label">{{ country or 'Unknown' }}</span>
                                <span class="stats-value badge bg-primary">{{ count }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted mb-0 text-center py-3">Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Î∏åÎùºÏö∞Ï†ÄÎ≥Ñ ÌÜµÍ≥Ñ -->
        <div class="col-md-6 col-lg-4">
            <div class="card analysis-card">
                <div class="card-header">
                    <i class="bi bi-browser-chrome me-2"></i>Î∏åÎùºÏö∞Ï†ÄÎ≥Ñ ÌÜµÍ≥Ñ
                </div>
                <div class="card-body">
                    {% if stats.by_browser %}
                        <div class="stats-list">
                            {% for browser, count in stats.by_browser.items()|sort(attribute='1', reverse=true)|list[:5] %}
                            <div class="stats-item">
                                <span class="stats-label">
                                    <i class="bi bi-{{ 'browser-chrome' if browser == 'Chrome' else 'browser-safari' if browser == 'Safari' else 'browser-firefox' if browser == 'Firefox' else 'browser-edge' if browser == 'Edge' else 'globe' }} me-1"></i>
                                    {{ browser or 'Unknown' }}
                                </span>
                                <span class="stats-value badge bg-info">{{ count }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted mb-0 text-center py-3">Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Ïñ∏Ïñ¥Î≥Ñ ÌÜµÍ≥Ñ -->
        <div class="col-md-6 col-lg-4">
            <div class="card analysis-card">
                <div class="card-header">
                    <i class="bi bi-translate me-2"></i>Ïñ∏Ïñ¥Î≥Ñ ÌÜµÍ≥Ñ
                </div>
                <div class="card-body">
                    {% if stats.by_language %}
                        <div class="stats-list">
                            {% for lang, count in stats.by_language.items()|sort(attribute='1', reverse=true)|list[:5] %}
                            <div class="stats-item">
                                <span class="stats-label">
                                    {% if lang == 'ko' %}üá∞üá∑ ÌïúÍµ≠Ïñ¥
                                    {% elif lang == 'en' %}üá∫üá∏ ÏòÅÏñ¥
                                    {% elif lang == 'ja' %}üáØüáµ ÏùºÎ≥∏Ïñ¥
                                    {% elif lang == 'zh' %}üá®üá≥ Ï§ëÍµ≠Ïñ¥
                                    {% elif lang == 'es' %}üá™üá∏ Ïä§ÌéòÏù∏Ïñ¥
                                    {% else %}{{ lang|upper }}
                                    {% endif %}
                                </span>
                                <span class="stats-value badge bg-secondary">{{ count }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted mb-0 text-center py-3">Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- ÌéòÏù¥ÏßÄÎ≥Ñ ÌÜµÍ≥Ñ -->
        <div class="col-md-6 col-lg-4">
            <div class="card analysis-card">
                <div class="card-header">
                    <i class="bi bi-file-earmark-text me-2"></i>ÌéòÏù¥ÏßÄÎ≥Ñ Î∞©Î¨∏
                </div>
                <div class="card-body">
                    {% if stats.by_page %}
                        <div class="stats-list">
                            {% for page_name, count in stats.by_page.items()|sort(attribute='1', reverse=true)|list[:5] %}
                            <div class="stats-item">
                                <span class="stats-label">{{ page_name or 'Unknown' }}</span>
                                <span class="stats-value badge bg-success">{{ count }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted mb-0 text-center py-3">Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- ÎîîÎ∞îÏù¥Ïä§Î≥Ñ ÌÜµÍ≥Ñ -->
        <div class="col-md-6 col-lg-4">
            <div class="card analysis-card">
                <div class="card-header">
                    <i class="bi bi-phone me-2"></i>ÎîîÎ∞îÏù¥Ïä§Î≥Ñ ÌÜµÍ≥Ñ
                </div>
                <div class="card-body">
                    {% if stats.by_device %}
                        <div class="stats-list">
                            {% for device, count in stats.by_device.items()|sort(attribute='1', reverse=true)|list[:5] %}
                            <div class="stats-item">
                                <span class="stats-label">
                                    <i class="bi bi-{{ 'phone' if device == 'Mobile' else 'tablet' if device == 'Tablet' else 'laptop' }} me-1"></i>
                                    {{ device or 'Unknown' }}
                                </span>
                                <span class="stats-value badge bg-warning">{{ count }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted mb-0 text-center py-3">Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Í∏∞Í∞Ñ ÌïÑÌÑ∞ -->
        <div class="col-md-6 col-lg-4">
            <div class="card analysis-card">
                <div class="card-header">
                    <i class="bi bi-calendar-range me-2"></i>Î∂ÑÏÑù Í∏∞Í∞Ñ
                </div>
                <div class="card-body text-center py-3">
                    <div class="btn-group-vertical w-100" role="group">
                        <a href="{{ url_for('admin.sessions_dashboard', days=1, sort_by=sort_by, sort_order=sort_order) }}" 
                           class="btn btn-{{ 'primary' if days == 1 else 'outline-primary' }} btn-sm">
                            Ïò§Îäò
                        </a>
                        <a href="{{ url_for('admin.sessions_dashboard', days=7, sort_by=sort_by, sort_order=sort_order) }}" 
                           class="btn btn-{{ 'primary' if days == 7 else 'outline-primary' }} btn-sm">
                            ÏµúÍ∑º 7Ïùº
                        </a>
                        <a href="{{ url_for('admin.sessions_dashboard', days=30, sort_by=sort_by, sort_order=sort_order) }}" 
                           class="btn btn-{{ 'primary' if days == 30 else 'outline-primary' }} btn-sm">
                            ÏµúÍ∑º 30Ïùº
                        </a>
                        <a href="{{ url_for('admin.sessions_dashboard', days=90, sort_by=sort_by, sort_order=sort_order) }}" 
                           class="btn btn-{{ 'primary' if days == 90 else 'outline-primary' }} btn-sm">
                            ÏµúÍ∑º 90Ïùº
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌïÑÌÑ∞ Î∞è Ï†ïÎ†¨ -->
    <div class="card mb-4">
        <div class="card-body py-3">
            <form method="GET" class="row g-3 align-items-end">
                <div class="col-auto">
                    <label class="form-label">Ï†ïÎ†¨ Í∏∞Ï§Ä:</label>
                    <select name="sort_by" class="form-select">
                        <option value="timestamp" {% if sort_by == 'timestamp' %}selected{% endif %}>Ï†ëÏÜç ÏãúÍ∞Ñ</option>
                        <option value="ip_address" {% if sort_by == 'ip_address' %}selected{% endif %}>IP Ï£ºÏÜå</option>
                        <option value="tokens_used" {% if sort_by == 'tokens_used' %}selected{% endif %}>ÌÜ†ÌÅ∞ ÏÇ¨Ïö©</option>
                        <option value="cost_usd" {% if sort_by == 'cost_usd' %}selected{% endif %}>ÎπÑÏö©</option>
                    </select>
                </div>
                <div class="col-auto">
                    <label class="form-label">Ï†ïÎ†¨ ÏàúÏÑú:</label>
                    <select name="sort_order" class="form-select">
                        <option value="desc" {% if sort_order == 'desc' %}selected{% endif %}>ÎÇ¥Î¶ºÏ∞®Ïàú</option>
                        <option value="asc" {% if sort_order == 'asc' %}selected{% endif %}>Ïò§Î¶ÑÏ∞®Ïàú</option>
                    </select>
                </div>
                <!-- Ïà®Í≤®ÏßÑ Í∏∞Ï°¥ ÌååÎùºÎØ∏ÌÑ∞ Ïú†ÏßÄ -->
                <input type="hidden" name="days" value="{{ days }}">
                <div class="col-auto">
                    <button type="submit" class="btn btn-success">
                        Ï†ÅÏö©
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ÏÑ∏ÏÖò Î™©Î°ù Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="mb-0">
            <i class="bi bi-list-ul me-2"></i>ÏÑ∏ÏÖò Î™©Î°ù
        </h5>
        <span class="badge bg-info">
            Ï¥ù {{ total_count }}Í∞ú (ÌéòÏù¥ÏßÄ {{ page }}/{{ total_pages if total_pages > 0 else 1 }})
        </span>
    </div>

    <!-- ÏÑ∏ÏÖò ÌÖåÏù¥Î∏î -->
    <div class="card">
        <div class="card-header">
            <input type="checkbox" id="selectAll" class="form-check-input me-2">
            <label for="selectAll" class="form-check-label">Ï†ÑÏ≤¥ ÏÑ†ÌÉù</label>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th style="width: 40px;"></th>
                            <th>Ï†ëÏÜç ÏãúÍ∞Ñ ‚Üì</th>
                            <th>IP Ï£ºÏÜå</th>
                            <th>ÏúÑÏπò</th>
                            <th>Î∏åÎùºÏö∞Ï†Ä</th>
                            <th class="text-end">ÌÜ†ÌÅ∞ ÏÇ¨Ïö©</th>
                            <th class="text-end">ÎπÑÏö©</th>
                            <th>Ïñ∏Ïñ¥</th>
                            <th>ÏÑúÎπÑÏä§ ÌéòÏù¥ÏßÄ</th>
                            <th style="width: 50px;"></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if sessions %}
                        {% for session in sessions %}
                        <tr>
                            <td>
                                <input type="checkbox" class="form-check-input session-checkbox" value="{{ session._id }}">
                            </td>
                            <td>
                                <small>
                                    {% if session.timestamp_kst %}
                                    {{ session.timestamp_kst.strftime('%Y-%m-%d %H:%M:%S') }} KST
                                    {% elif session.timestamp %}
                                    {{ session.timestamp.strftime('%Y-%m-%d %H:%M:%S') }} UTC
                                    {% else %}
                                    N/A
                                    {% endif %}
                                </small>
                            </td>
                            <td>
                                <code>{{ session.ip_address or 'Unknown' }}</code>
                            </td>
                            <td>
                                {% if session.location %}
                                <span title="{{ session.location.isp or '' }}">
                                    {{ session.location.country or 'Unknown' }}
                                    {% if session.location.city and session.location.city != 'Unknown' %}
                                    - {{ session.location.city }}
                                    {% endif %}
                                </span>
                                {% else %}
                                Unknown
                                {% endif %}
                            </td>
                            <td>
                                {% if session.user_agent %}
                                <span class="badge bg-{{ 'primary' if session.user_agent.browser == 'Chrome' else 'info' if session.user_agent.browser == 'Safari' else 'warning' if session.user_agent.browser == 'Firefox' else 'secondary' }}" title="{{ session.user_agent.raw or '' }}">
                                    {{ session.user_agent.browser or 'Unknown' }}
                                </span>
                                {% else %}
                                Unknown
                                {% endif %}
                            </td>
                            <td class="text-end">
                                {{ session.tokens_used or 0 }}
                            </td>
                            <td class="text-end">
                                US${{ "%.4f" | format(session.cost_usd or 0) }}
                            </td>
                            <td>
                                <span class="badge bg-outline-secondary">{{ session.language or 'ko' }}</span>
                            </td>
                            <td>
                                {% if session.service_page %}
                                <span class="badge bg-{{ 'success' if session.service_page == 'Home' else 'primary' if session.service_page == 'Service' else 'info' if session.service_page == 'Gallery' else 'warning' if session.service_page == 'Booking' else 'secondary' }}">
                                    {{ session.service_page }}
                                </span>
                                {% else %}
                                <span class="text-danger"><i class="bi bi-x"></i></span>
                                {% endif %}
                            </td>
                            <td>
                                <form method="POST" action="{{ url_for('admin.delete_session', session_id=session._id) }}" class="d-inline" onsubmit="return confirm('Ïù¥ ÏÑ∏ÏÖò Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?');">
                                    <button type="submit" class="btn btn-sm btn-link text-muted p-0" title="ÏÇ≠Ï†ú">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                        {% else %}
                        <tr>
                            <td colspan="10" class="text-center py-5">
                                <i class="bi bi-inbox fs-1 d-block mb-3 text-muted"></i>
                                <p class="text-muted mb-0">ÏÑ∏ÏÖò Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                                <small class="text-muted">Î∞©Î¨∏ÏûêÍ∞Ä ÏÇ¨Ïù¥Ìä∏Ïóê Ï†ëÏÜçÌïòÎ©¥ Ïó¨Í∏∞Ïóê Í∏∞Î°ùÎê©ÎãàÎã§.</small>
                            </td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- ÌéòÏù¥Ïßï -->
        {% if total_pages > 1 %}
        <div class="card-footer">
            <nav aria-label="ÏÑ∏ÏÖò ÌéòÏù¥ÏßÄ">
                <ul class="pagination pagination-sm mb-0 justify-content-center">
                    {% if page > 1 %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('admin.sessions_dashboard', page=page-1, days=days, sort_by=sort_by, sort_order=sort_order) }}">
                            <i class="bi bi-chevron-left"></i>
                        </a>
                    </li>
                    {% endif %}
                    
                    {% for p in range(1, total_pages + 1) %}
                    {% if p == page %}
                    <li class="page-item active"><span class="page-link">{{ p }}</span></li>
                    {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('admin.sessions_dashboard', page=p, days=days, sort_by=sort_by, sort_order=sort_order) }}">{{ p }}</a>
                    </li>
                    {% elif p == page - 3 or p == page + 3 %}
                    <li class="page-item disabled"><span class="page-link">...</span></li>
                    {% endif %}
                    {% endfor %}
                    
                    {% if page < total_pages %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('admin.sessions_dashboard', page=page+1, days=days, sort_by=sort_by, sort_order=sort_order) }}">
                            <i class="bi bi-chevron-right"></i>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
        {% endif %}
    </div>
</div>

<style>
/* ÌÜµÍ≥Ñ Ïπ¥Îìú Ïä§ÌÉÄÏùº */
.stats-card {
    display: flex;
    align-items: center;
    padding: 1.25rem;
    border-radius: 12px;
    background: rgba(18, 0, 36, 0.6);
    border: 1px solid rgba(200, 170, 255, 0.3);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.stats-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(200, 170, 255, 0.15);
}

.stats-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: #fff;
    flex-shrink: 0;
}

.stats-content {
    margin-left: 1rem;
}

.stats-content h3 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0;
    color: #fff;
}

.stats-content p {
    margin-bottom: 0;
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.7);
}

.bg-primary-subtle {
    background: linear-gradient(135deg, rgba(13, 110, 253, 0.15), rgba(13, 110, 253, 0.05));
    border-color: rgba(13, 110, 253, 0.3);
}

.bg-success-subtle {
    background: linear-gradient(135deg, rgba(25, 135, 84, 0.15), rgba(25, 135, 84, 0.05));
    border-color: rgba(25, 135, 84, 0.3);
}

.bg-warning-subtle {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 193, 7, 0.05));
    border-color: rgba(255, 193, 7, 0.3);
}

.bg-danger-subtle {
    background: linear-gradient(135deg, rgba(220, 53, 69, 0.15), rgba(220, 53, 69, 0.05));
    border-color: rgba(220, 53, 69, 0.3);
}

/* Î∂ÑÏÑù Ïπ¥Îìú Ïä§ÌÉÄÏùº */
.analysis-card {
    background: rgba(18, 0, 36, 0.6);
    border: 1px solid rgba(200, 170, 255, 0.3);
    border-radius: 12px;
    height: 100%;
}

.analysis-card .card-header {
    background: rgba(200, 170, 255, 0.1);
    border-bottom: 1px solid rgba(200, 170, 255, 0.2);
    color: #E8D4FF;
    font-weight: 600;
    border-radius: 12px 12px 0 0;
}

.stats-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.stats-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid rgba(200, 170, 255, 0.1);
}

.stats-item:last-child {
    border-bottom: none;
}

.stats-label {
    color: rgba(255, 255, 255, 0.85);
    font-size: 0.9rem;
}

.stats-value {
    font-weight: 600;
}

.card {
    background: rgba(18, 0, 36, 0.6);
    border: 1px solid rgba(200, 170, 255, 0.3);
}

.card-header {
    background: rgba(200, 170, 255, 0.1);
    border-bottom: 1px solid rgba(200, 170, 255, 0.2);
    color: #E8D4FF;
}

.card-footer {
    background: rgba(200, 170, 255, 0.05);
    border-top: 1px solid rgba(200, 170, 255, 0.2);
}

.table {
    color: rgba(255, 255, 255, 0.85);
}

.table thead th {
    border-bottom-color: rgba(200, 170, 255, 0.2);
    color: #E8D4FF;
    font-weight: 600;
    font-size: 0.85rem;
}

.table td {
    border-bottom-color: rgba(200, 170, 255, 0.1);
    vertical-align: middle;
}

.table-hover tbody tr:hover {
    background-color: rgba(200, 170, 255, 0.08);
}

code {
    color: #0dcaf0;
    background: rgba(13, 202, 240, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.8rem;
}

.form-control, .form-select {
    background-color: rgba(18, 0, 36, 0.8);
    border-color: rgba(200, 170, 255, 0.3);
    color: #fff;
}

.form-control:focus, .form-select:focus {
    background-color: rgba(18, 0, 36, 0.9);
    border-color: rgba(200, 170, 255, 0.6);
    color: #fff;
    box-shadow: 0 0 0 0.25rem rgba(200, 170, 255, 0.15);
}

.form-label {
    color: #E8D4FF;
    font-size: 0.85rem;
}

.alert-info {
    background: rgba(13, 202, 240, 0.15);
    border: 1px solid rgba(13, 202, 240, 0.3);
    color: #0dcaf0;
}

.page-link {
    background-color: rgba(18, 0, 36, 0.6);
    border-color: rgba(200, 170, 255, 0.3);
    color: #E8D4FF;
}

.page-link:hover {
    background-color: rgba(200, 170, 255, 0.2);
    border-color: rgba(200, 170, 255, 0.5);
    color: #fff;
}

.page-item.active .page-link {
    background-color: rgba(200, 170, 255, 0.3);
    border-color: rgba(200, 170, 255, 0.5);
}

.page-item.disabled .page-link {
    background-color: transparent;
    border-color: rgba(200, 170, 255, 0.2);
    color: rgba(255, 255, 255, 0.4);
}

.badge.bg-outline-secondary {
    background: transparent;
    border: 1px solid rgba(200, 170, 255, 0.5);
    color: #E8D4FF;
}

/* Light Mode */
body.light-mode .stats-card {
    background: #fff;
    border-color: rgba(139, 92, 246, 0.2);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

body.light-mode .stats-card:hover {
    box-shadow: 0 8px 20px rgba(139, 92, 246, 0.15);
}

body.light-mode .stats-content h3 {
    color: #333;
}

body.light-mode .stats-content p {
    color: #666;
}

body.light-mode .bg-primary-subtle {
    background: linear-gradient(135deg, rgba(13, 110, 253, 0.1), rgba(13, 110, 253, 0.02));
}

body.light-mode .bg-success-subtle {
    background: linear-gradient(135deg, rgba(25, 135, 84, 0.1), rgba(25, 135, 84, 0.02));
}

body.light-mode .bg-warning-subtle {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.02));
}

body.light-mode .bg-danger-subtle {
    background: linear-gradient(135deg, rgba(220, 53, 69, 0.1), rgba(220, 53, 69, 0.02));
}

body.light-mode .analysis-card {
    background: #fff;
    border-color: rgba(139, 92, 246, 0.2);
}

body.light-mode .analysis-card .card-header {
    background: rgba(139, 92, 246, 0.08);
    border-bottom-color: rgba(139, 92, 246, 0.15);
    color: #5B3A8C;
}

body.light-mode .stats-item {
    border-bottom-color: rgba(0, 0, 0, 0.08);
}

body.light-mode .stats-label {
    color: #333;
}

body.light-mode .card {
    background: rgba(255, 255, 255, 0.95);
    border-color: rgba(139, 92, 246, 0.2);
}

body.light-mode .card-header {
    background: rgba(139, 92, 246, 0.08);
    border-bottom-color: rgba(139, 92, 246, 0.15);
    color: #5B3A8C;
}

body.light-mode .table {
    color: #333;
}

body.light-mode .table thead th {
    color: #5B3A8C;
    border-bottom-color: rgba(139, 92, 246, 0.2);
}

body.light-mode .table td {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}

body.light-mode .table-hover tbody tr:hover {
    background-color: rgba(139, 92, 246, 0.05);
}

body.light-mode code {
    color: #0a8fa5;
}

body.light-mode .form-control,
body.light-mode .form-select {
    background-color: #fff;
    border-color: rgba(139, 92, 246, 0.3);
    color: #333;
}

body.light-mode .form-label {
    color: #5B3A8C;
}

body.light-mode .alert-info {
    background: rgba(13, 202, 240, 0.1);
    border-color: rgba(13, 202, 240, 0.2);
    color: #0a8fa5;
}

body.light-mode .page-link {
    background-color: #fff;
    border-color: rgba(139, 92, 246, 0.2);
    color: #5B3A8C;
}

body.light-mode .page-item.active .page-link {
    background-color: rgba(139, 92, 246, 0.2);
    border-color: rgba(139, 92, 246, 0.4);
}

body.light-mode .badge.bg-outline-secondary {
    border-color: rgba(139, 92, 246, 0.5);
    color: #5B3A8C;
}
</style>

<script>
// Ï†ÑÏ≤¥ ÏÑ†ÌÉù Ï≤¥ÌÅ¨Î∞ïÏä§
document.getElementById('selectAll').addEventListener('change', function() {
    const checkboxes = document.querySelectorAll('.session-checkbox');
    checkboxes.forEach(cb => cb.checked = this.checked);
});
</script>
{% endblock %}
